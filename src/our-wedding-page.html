<dom-module id="our-wedding-page">
  <!-- Defines the element's style and local DOM -->
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <app-route route="{{route}}"
               pattern="/:subpage"
               active="{{subpageActive}}"
               data="{{subpageData}}"></app-route>

    <!-- CONTENT PARTS -->
    <div id="main"></div>


  </template>
  <!-- Creates the element's prototype and registers it -->
  <script>
    Polymer({
      is: 'our-wedding-page',

      properties: {
        subpage: {
          type: String,
          reflectToAttribute: true,
          observer: '_pageChanged'
        },
        dataPage: {
          type: String
        }
      },

      observers: [
        '_routePageChanged(subpageData.subpage)'
      ],

      _routePageChanged: function (subpage) {
        this.subpage = subpage || 'starter';
      },

      _pageChanged: function (subpage) {


        /* jump to page-section */
//        this.querySelector('#' + subpage).scrollIntoView();
      },

      created: function() {
        console.log(this.localName + '#' + this.id + ' was created');
      },

      ready: function (subpage) {

        console.log(this.localName + '#' + this.id + ' has local DOM initialized');


//        console.log("this.subpage: " + this.subpage);
//        console.log("subpage: " + subpage);
//        console.log("itmes:" + this.items);
//        console.log("itmes-length:" + this.items.length);

        for (var x = 0, y = this.items.length; x < y; x += 1) {

          var mainPage = this.dataPage,
                  item = this.items[x];

          /* create html-import */
          var resolvedPageUrl = this.resolveUrl('our-' + mainPage + '-' + item + '.html');
          this.importHref(resolvedPageUrl, null, null, true);

          var containerElement = document.createElement('div'),
                  dynamicElement = document.createElement('our-brautpaar-' + item);
          containerElement.id = item;
          containerElement.className = 'page-section';
          containerElement.appendChild(dynamicElement);
          Polymer.dom(this.$.main).appendChild(containerElement);
        } //TODO: irgendwie ist es komisch, dass ich jedes Mal, wenn die subpage ändert, den ganzen DOM aufbauen muss. Eigentlich sollte das doch vorher geschehen, aber ich bringes es nicht hin... Ich glaube hier liegt auch das Problem, dass bei jedem Laden einer subpage der ganze Content hinzugefügt wird. Irgendiwe muss ich die Erstellung des Contents auf das "ready" oder "created" auslagern...

      },

      attached: function() {
        console.log(this.localName + '#' + this.id + ' was attached');
      },

      detached: function() {
        console.log(this.localName + '#' + this.id + ' was detached');
      },

      attributeChanged: function(name, type) {
        console.log(this.localName + '#' + this.id + ' attribute ' + name +
                ' was changed to ' + this.getAttribute(name));
      }

    });
  </script>
</dom-module>