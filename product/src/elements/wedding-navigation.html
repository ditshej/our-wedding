<!-- general polymer elements -->
<link rel="import" href="/src/shared/shared-polymer-header.html">
<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="/bower_components/paper-menu-button/paper-menu-button.html">
<link rel="import" href="/bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="/bower_components/iron-icon/iron-icon.html">
<link rel="import" href="/bower_components/iron-icons/iron-icons.html">
<link rel="import" href="/bower_components/paper-menu/paper-menu.html">
<link rel="import" href="/bower_components/paper-item/paper-item.html">

<!-- other imports -->
<link rel="import" href="/src/shared/shared-jquery.html">

<dom-module id="wedding-navigation">
  <!-- Defines the element's style and local DOM -->
  <template>
    <style include="shared-styles iron-flex iron-flex-alignment">
      :host {
        display: block;
        position: fixed;
        z-index: 1000;
        width: 100%;
        /*--wedding-nav-item-padding: 3px;*/
      }

      nav {
        height: 60px;
      }

      /*TODO: im moment überdeckt die Navigation den ganzen oberen Teil der Webseite so, dass man dort keine Links klicken kann!!!*/

      /** navigation */
      /* page-top-style */
      /*ul {*/
      /*list-style-type: none;*/
      /*padding: 0;*/
      /*}*/

      /*a {*/
      /*padding: inherit;*/
      /*}*/

      /*:host > ul > li {*/
      /*float: left;*/
      /*width: 20%;*/
      /*text-align: center;*/
      /*padding: var(--wedding-nav-item-padding);*/
      /*}*/

      /*:host > ul > li > ul {*/
      /*display: none;*/
      /*}*/

      /*:host > ul > li > ul > li {*/
      /*padding: var(--wedding-nav-item-padding);*/
      /*}*/

      /*!* page-scroll-style *!*/
      /*:host > ul.scroll {*/
      /*float: right;*/
      /*width: 20%;*/
      /*}*/

      /*:host > ul > li.scroll {*/
      /*float: none;*/
      /*width: auto;*/
      /*text-align: right;*/
      /*}*/

      /*!* collapse-style *!*/

      /*!** logo *!*/
      /*.logo {*/
      /*display: inline-block;*/
      /*width: 40%;*/
      /*}*/

      /*img {*/
      /*width: 100%;*/
      /*}*/

      /*@media (max-width: 750px) {*/
      /*#nav {*/
      /*display: none;*/
      /*}*/
      /*}*/

    </style>

    <!-- local DOM -->
    <nav class="fullbleed layout vertical">
      <paper-menu-button class="horizontal end-justified layout"
                         no-overlap
                         ignore-select
                         close-on-activate
                         horizontal-align="right">
        <paper-icon-button icon="menu" class="dropdown-trigger"></paper-icon-button>
        <paper-menu class="dropdown-content">
          <paper-submenu>
            <paper-item><a href="/brautpaar.html">Brautpaar</a></paper-item>
            <paper-menu>
              <paper-item><a href="#geschichte">Geschichte</a></paper-item>
              <paper-item><a href="#braut">Braut</a></paper-item>
              <paper-item><a href="#braeutigam">Bräutigam</a></paper-item>
              <paper-item><a href="#gallery">Bilder-Galerie</a></paper-item>
            </paper-menu>
          </paper-submenu>
          <paper-submenu>
            <paper-item><a href="/trauung.html">Trauung</a></paper-item>
            <paper-menu>
              <paper-item><a href="#zivil">Zivile Trauung</a></paper-item>
              <paper-item><a href="#kirchlich">Kirchliche Trauung</a></paper-item>
              <paper-item><a href="#festlichkeiten">Festlichkeiten</a></paper-item>
            </paper-menu>
          </paper-submenu>
          <paper-submenu>
            <paper-item><a href="/organisation.html">Organisation</a></paper-item>
            <paper-menu>
              <paper-item><a href="#trauzeugen">Trauzeugen</a></paper-item>
              <paper-item><a href="#ok">OK-Team</a></paper-item>
            </paper-menu>
          </paper-submenu>
          <paper-item><a href="/geschenke.html">Geschenke</a></paper-item>
          <paper-item><a href="/anmeldung.html">Anmeldung</a></paper-item>
        </paper-menu>
      </paper-menu-button>
    </nav>


  </template>
  <!-- Creates the element's prototype and registers it -->
  <script>
    Polymer({
      is: 'wedding-navigation',

      ready: function () {
        /** general */
        /* Variables */
        var url = window.location.pathname,
          filename = url.substring(url.lastIndexOf('/') + 1),
          fileString = filename.substring(0, filename.lastIndexOf('.')),
          fileStringWithoutDash = fileString.lastIndexOf('-') > 0 ? fileString.substring(0, fileString.lastIndexOf('-')) : fileString,
          $mainItem = $(this.querySelector('#nav-' + fileStringWithoutDash)),
          $logo = $(this.$.logo),
          $subItemList = $mainItem.children('ul'),
          $nav = $(this.$.nav),
          $navChildren = $nav.children(),
          navHalf = $navChildren.length / 2;

        /* hide the current main nav item depending on the filename.
         * even if the filename is extended with "-something", it will grap just the first word.
         * That way, it's possible to build a "page-something.html" as background-page of "page.html*/
        $mainItem.hide();

        /* add the current sub-items to the logo and show them */
        $logo.append($subItemList);
        $subItemList.css('display', 'block');

        /** on page-top */
        /* move the logo to the center */
        setLogo(navHalf, $mainItem, $logo);


        /** on page-scroll */
        /* as soon as the user scrolls... */
        document.onscroll = function () {

          /* as soon as the scrollbar is more than 10px scrolled down.. */
          if (window.scrollY >= 10) {
            /* give the scroll-classes to the correct elements */
            for (var i = 0; i < $navChildren.length; i++) {
              $nav.addClass('scroll');
              $($navChildren[i]).addClass('scroll');
            }
            /* move the logo to first position */
            setLogo(0, $mainItem, $logo);

          } else { /* if the scrollbar goes back to less than 10px scrolled down.. */
            /* remove the scroll-classes again */
            for (var ii = 0; ii < $navChildren.length; ii++) {
              $nav.removeClass('scroll');
              $($navChildren[ii]).removeClass('scroll');
            }
            /* move the logo back to center */
            setLogo(navHalf, $mainItem, $logo);
          }
        };

        /* set the current sub-items circular */
//        var $subItems = $subItemList.children();
//        $($subItems[0]).css('transform', 'translate(-50%, -250%)');
//        $($subItems[1]).css('transform', 'translate(0, -200%)');
//        $($subItems[2]).css('transform', 'translate(50%, -450%)');
//

        /** FUNCTIONS */
        /**
         *
         * @param position
         * @param $mainItem
         * @param $logo
         */
        function setLogo(position, $mainItem, $logo) {
          if ($mainItem.index() <= position) {
            $($logo.parent().children()[(position)]).after($logo);
          } else {
            $($logo.parent().children()[(position)]).before($logo);
          }

        }
      }


    });
  </script>
</dom-module>