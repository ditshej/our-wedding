<!-- general polymer elements -->
<link rel="import" href="/src/shared/shared-polymer-header.html">
<!-- specific polymer elements -->
<link rel="import" href="/src/elements/wedding-navigation.html">
<link rel="import" href="/src/elements/wedding-eyecatcher.html">
<link rel="import" href="/src/elements/wedding-present.html">
<!-- other imports -->
<link rel="import" href="/src/shared/shared-jquery.html">

<dom-module id="wedding-geschenke">
  <template>
    <style include="shared-styles">
      :host {
        display: block;

        /* height for Sticky Footer */
        height: 100%;

        /* Variables */
        --wedding-present-primary-bg-color: var(--primary-color);
        --wedding-present-primary-text-color: var(--secondary-text-color);
        --wedding-present-secondary-bg-color: var(--secondary-color);
        --wedding-present-secondary-text-color: var(--secondary-text-color);
      }

      #present-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
      }

      /* helpclass to hide */
      .hidden {
        display: none;
      }
    </style>
    <!-- wrapper to create Sticky Footer -->
    <div class="page-wrapper">
      <!-- local DOM -->
    <wedding-navigation></wedding-navigation>
    <wedding-eyecatcher title="Geschenke"
                        img="https://placeimg.com/1280/900/any/sepia"></wedding-eyecatcher>


    <div><h2>Erkl√§rung</h2>
      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Corporis deserunt eos exercitationem expedita impedit
        laborum, molestiae nobis numquam quasi quibusdam, repellat unde voluptas? A at atque aut earum harum, ipsam iste
        magnam magni maiores pariatur perferendis placeat quisquam repellat repellendus tempore velit voluptatem.
        Deleniti fugit obcaecati quibusdam veritatis! Ad asperiores aspernatur delectus distinctio earum eligendi, esse
        facilis harum inventore maxime modi mollitia neque officia omnis qui quis quo, quod quos sit ullam? Accusantium
        aut corporis dicta impedit optio repellat sed sequi suscipit, totam velit! A ad consequuntur cumque dolorum
        totam ullam vitae voluptates? Commodi error et maxime numquam officia officiis.</p>
    </div>
    <div id="present-container"></div>

      <!-- push to create Sticky Footer -->
      <div class="sticky-footer-push"></div>
    </div><!-- page-wrapper end -->
    <!-- Footer -->
    <wedding-footer></wedding-footer>
  </template>

  <script>
    Polymer({
      is: 'wedding-geschenke',

      ready: function () {

        /** ajax request to get presents-data form "/getpresent" in json */
        $.ajax('/getpresent', {
          type: 'GET',
          contentType: 'json',
          success: function (data) {
            /* Create <wedding-present>-Elements with given Data */
            createPresents(data);
          },
          error: function () {
            console.log('error');
          }
        });


        /**
         * Create <wedding-present>-Elements with given Data
         * @param presentsArray (array) Array with objects{ title, description, cost, img }
         */
        var createPresents = function createPresents(presentsArray) {
          /* fetch the DOM-Element to put the <wedding-present>-Elemenets in */
          var $presentContainer = $('#present-container');

          /* for every Element in the given presentArray create a <wedding-present>-Element and add it to the Container */
          for (var i = 0; i < presentsArray.length; i++) {
            /* create class to hide element, if sold is set to true in presentArray */
            var sold = presentsArray[i].sold ? ' hidden' : undefined,
                    /* define <wedding-present>-Element */
              $weddingPresentElement = $('<wedding-present></wedding-present>', {
                id: presentsArray[i].id,
                title: presentsArray[i].title,
                img: presentsArray[i].img,
                imgalt: presentsArray[i].img.slice(0, -4),
                description: presentsArray[i].description,
                cost: presentsArray[i].cost,
                class: 'scope-style wedding-geschenke' + sold
              });
            /* append <wedding-present>-Element to the Container */
            $presentContainer.append($weddingPresentElement);
          }
        };


      }

    });
  </script>
</dom-module>